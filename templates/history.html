{% extends "base.html" %}
{% block content %}
<style>
  /* Small local tweaks to keep the list tidy and match site visuals */
  .history-container { max-width: 1000px; margin: 24px auto; padding: 0 16px; }
  .meeting-card { display:flex; align-items:center; justify-content:space-between; padding:14px; border:1px solid var(--border-color, #e6e6e6); border-radius:8px; background:var(--card-bg, #fff); margin-bottom:12px; box-shadow: 0 1px 2px rgba(0,0,0,0.03); }
  .meeting-meta { color: var(--muted, #6c757d); font-size:0.95rem; margin-top:4px; }
  .meeting-left { display:flex; gap:14px; align-items:center; min-width:0; }
  .meeting-title { font-weight:600; color: var(--text-color, #222); margin:0; overflow:hidden; text-overflow:ellipsis; max-width:100%; line-height:1.3; }
  .meeting-date-badge { font-size:0.85rem; padding:6px 8px; border-radius:6px; background:var(--accent, #1e90ff); color:#fff; }
  .meeting-actions { display:flex; gap:8px; align-items:center; flex-shrink:0; }
  .meeting-actions .btn { white-space:nowrap; min-width:60px; }
  .small-muted { font-size:0.85rem; color:var(--muted, #6c757d); }
  .no-meetings { padding:20px; text-align:center; color:var(--muted, #6c757d); }
  /* Make View button green */
  .btn-view-green { background-color: #28a745; color: white; border-color: #28a745; }
  .btn-view-green:hover { background-color: #218838; border-color: #1e7e34; }
  /* responsive */
  @media (max-width:640px) {
    .meeting-card { flex-direction:column; align-items:flex-start; gap:12px; }
    .meeting-left { flex-direction:column; align-items:flex-start; gap:6px; width:100%; }
    .meeting-title { max-width:100%; }
    .meeting-actions { width:100%; justify-content:flex-start; }
  }
</style>
<div class="history-container">
  <div class="page-header">
    <h1 style="margin-bottom:6px">History</h1>
    <p class="small-muted" style="margin-top:0">All your uploaded meetings and analyses — click a row to view details.</p>
  </div>
  {% if meetings %}
    {% for m in meetings %}
      <div class="meeting-card" role="article" aria-labelledby="meeting-{{ m.id }}">
        <div class="meeting-left">
          <div>
            <h2 id="meeting-{{ m.id }}" class="meeting-title">
              <a href="{{ url_for('view_meeting', meeting_id=m.id) }}" style="color:inherit; text-decoration:none;">
                {{ m.meeting_name }}
              </a>
            </h2>
            <div class="meeting-meta">
              Uploaded by <strong>{{ m.user.username if m.user else 'unknown' }}</strong>
              &nbsp;•&nbsp;
              <span title="{{ m.uploaded_at.isoformat() if m.uploaded_at }}">{{ m.uploaded_at.strftime('%Y-%m-%d %H:%M') if m.uploaded_at else 'unknown' }}</span>
              {% if m.date %}
                &nbsp;•&nbsp;
                <span class="meeting-date-badge">{{ m.date.strftime('%Y-%m-%d') }}</span>
              {% endif %}
            </div>
          </div>
        </div>
        <div class="meeting-actions">
          <a class="btn btn-sm btn-view-green" href="{{ url_for('view_meeting', meeting_id=m.id) }}">View</a>
          <form method="post" action="{{ url_for('delete_meeting', meeting_id=m.id) }}" onsubmit="return confirm('Delete this meeting?');" style="display:inline;">
            <button type="submit" class="btn btn-sm btn-danger">Delete</button>
          </form>
        </div>
      </div>
    {% endfor %}
  {% else %}
    <div class="no-meetings">
      <p><strong>No meetings uploaded yet.</strong></p>
      <p>Return to the dashboard to upload CSVs and run analyses.</p>
      <p><a href="{{ url_for('dashboard') }}" class="btn btn-primary">Go to Dashboard</a></p>
    </div>
  {% endif %}
</div>
{% endblock %}
